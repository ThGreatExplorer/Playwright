( (module cons (class ConsList (first rest) (method isEmpty () 1.0 ) (method addToFront (x) (new ConsList (x this)) ) (method contains (x) (def result 0.5) (def firstElem (this --> first)) (def restOfList (this --> rest)) (def zero 0.0) (if0 (firstElem == x) (result = zero) (result = (restOfList --> contains (x))) ) result ) (method length () (def one 1.0) (def restOfList (this --> rest)) (def result (restOfList --> length ())) (result + one) ) (method get (index) (def result 0.5) (def firstElem (this --> first)) (def restOfList (this --> rest)) (if0 index (result = firstElem) (block (def negOne -1.0) (def nextIndex (index + negOne)) (result = (restOfList --> get (nextIndex))) ) ) result ) ) ) (module empty (import cons) (class Empty () (method addToFront (x) (new ConsList (x this)) ) (method isEmpty () 0.0 ) (method contains (x) 1.0 ) (method length () 0.0 ) (method get (index) -1.0 ) ) ) (module node (import empty) (class Node (value childList) (method addChildNode (newNode) (def childList (this --> childList)) (def newNodeList (childList --> addToFront (newNode))) (this --> childList = newNodeList) this ) (method getNthChild (index) (def childList (this --> childList)) (childList --> get (index)) ) (method numChildren () (def childList (this --> childList)) (childList --> length ()) ) (method getSum () (def result (this --> value)) (def childList (this --> childList)) (def numLoops (childList --> length ())) (def keepLooping 0.0) (def one 1.0) (def i 0.0) (while0 keepLooping (block (if0 (i == numLoops) (keepLooping = 1.0) (block (def curNode (childList --> get (i))) (def value (curNode --> getSum ())) (result = (result + value)) (i = (i + one)) ) ) ) ) result ) (method contains (value) (def result 0.5) (def thisValue (this --> value)) (if0 (value == thisValue) (result = 0.0) (block (def childList (this --> childList)) (def numLoops (childList --> length ())) (def keepLooping 0.0) (def one 1.0) (def i 0.0) (while0 keepLooping (block (if0 (i == numLoops) (keepLooping = 1.0) (block (def curNode (childList --> get (i))) (if0 (curNode --> contains (value)) (block (result = 0.0) (keepLooping = 1.0) ) (block (i = (i + one)) ) ) ) ) ) ) ) ) result ) ) ) (module duplicateclass (import empty) (import node) (class ConsList (x) (method makeTree () (def empty (new Empty ())) (def value 0.1) (def leafOne (new Node (value empty))) (def value 0.2) (def leafTwo (new Node (value empty))) (def value 0.4) (def leafThree (new Node (value empty))) (def value 0.8) (def rootNode (new Node (value empty))) (def temp 0.0) (temp = (rootNode --> addChildNode (leafThree))) (temp = (rootNode --> addChildNode (leafTwo))) (temp = (rootNode --> addChildNode (leafOne))) (new ConsList (rootNode)) ) ) ) (import cons) (import empty) (import node) (import duplicateclass) (def empty (new Empty ())) (def value 1.1) (def leafOne (new Node (value empty))) (def value 2.2) (def leafTwo (new Node (value empty))) (def value 3.3) (def leafThree (new Node (value empty))) (def value 4.4) (def midNodeOne (new Node (value empty))) (def value 5.5) (def midNodeTwoThree (new Node (value empty))) (def value 6.6) (def rootNode (new Node (value empty))) (def temp 0.5) (def tempTwo 0.5) (def result -1.0) (def expected -420.0) (midNodeOne = (midNodeOne --> addChildNode (leafOne))) (midNodeTwoThree = (midNodeTwoThree --> addChildNode (leafThree))) (midNodeTwoThree = (midNodeTwoThree --> addChildNode (leafTwo))) (rootNode = (rootNode --> addChildNode (midNodeTwoThree))) (rootNode = (rootNode --> addChildNode (midNodeOne))) (temp = 1.1) (if0 (rootNode --> contains (temp)) (block (temp = 3.3) (if0 (rootNode --> contains (temp)) (block (temp = 5.5) (if0 (rootNode --> contains (temp)) (block (temp = 7.7) (if0 (rootNode --> contains (temp)) (result = -1.3) (block (def one 1.0) (def tempThree 0.0) (temp = (rootNode --> getNthChild (one))) (expected = 13.0) (tempThree = (temp --> getSum ())) (tempTwo = (temp --> numChildren ())) (temp = (tempThree + tempTwo)) (if0 (temp == expected) (block (result = (rootNode --> getSum ())) ) (result = -1.3) ) ) ) ) (result = -1.2) ) ) (result = -1.1) ) ) (result = -1.0) ) (expected = 23.1) (if0 (result == expected) (block (def temp 0.5) (def thingy (new ConsList (temp))) (thingy = (thingy --> makeTree ())) (thingy = (thingy --> x)) (result = (thingy --> getSum ())) ) (result = result) ) result )