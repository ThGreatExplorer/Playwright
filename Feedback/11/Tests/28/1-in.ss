( (module cons (class ConsList (first rest) (method isEmpty () 1.0 ) (method addToFront (x) (def first (this --> first)) (def rest (this --> rest)) (def copied (new ConsList (first rest))) (this --> rest = copied) (this --> first = x) 0.0 ) (method contains (x) (def result 0.5) (def firstElem (this --> first)) (def restOfList (this --> rest)) (def zero 0.0) (if0 (firstElem == x) (result = zero) (result = (restOfList --> contains (x))) ) result ) (method length () (def one 1.0) (def restOfList (this --> rest)) (def result (restOfList --> length ())) (result + one) ) (method get (index) (def result 0.5) (def firstElem (this --> first)) (def restOfList (this --> rest)) (if0 index (result = firstElem) (block (def negOne -1.0) (def nextIndex (index + negOne)) (result = (restOfList --> get (nextIndex))) ) ) result ) ) ) (module empty (import cons) (class Empty () (method addToFront (x) (new ConsList (x this)) ) (method isEmpty () 0.0 ) (method contains (x) 1.0 ) (method length () 0.0 ) (method get (index) -1.0 ) ) ) (tmodule leaf (class Leaf (value)) (((value Number)) ()) ) (module bintree (import leaf) (class Node (value left right) (method sum () (def result (this --> value)) (def left (this --> left)) (def right (this --> right)) (if0 (left isa Leaf) (block (def leftSum (left --> value)) (result = (result + leftSum)) ) (block (def leftSum (left --> sum ())) (result = (result + leftSum)) ) ) (if0 (right isa Leaf) (block (def rightSum (right --> value)) (result = (result + rightSum)) ) (block (def rightSum (right --> sum ())) (result = (result + rightSum)) ) ) result ) (method numNodesAndLeaves () (def result 1.0) (def left (this --> left)) (def right (this --> right)) (def one 1.0) (if0 (left isa Leaf) (result = (result + one)) (block (def leftCount (left --> numNodesAndLeaves ())) (result = (result + leftCount)) ) ) (if0 (right isa Leaf) (result = (result + one)) (block (def rightCount (right --> numNodesAndLeaves ())) (result = (result + rightCount)) ) ) result ) ) ) (module binwrap (import leaf) (import bintree) (class BinTree (root) (method setValueAt (value directionsList) (if0 (directionsList --> isEmpty ()) (block (def curNode (this --> root)) (curNode --> value = value) ) (block (def curNode (this --> root)) (def dummy 0.0) (def temp 0.0) (def zero 0.0) (def leftward -1.0) (def rightward 1.0) (def curDirection (directionsList --> first)) (def nextDirections (directionsList --> rest)) (if0 (curNode isa Leaf) (block (def zero 0.0) (def curNodeValue (curNode --> value)) (def newLeft (new Leaf (zero))) (def newRight (new Leaf (zero))) (curNode = (new Node (curNodeValue newLeft newRight))) (this --> root = curNode) ) (dummy = 0.0) ) (curNode = (this --> root)) (if0 (curDirection == leftward) (block (def newNode 0.0) (temp = (curNode --> left)) (newNode = (new BinTree (temp))) (temp = (newNode --> setValueAt (value nextDirections))) (newNode = (newNode --> root)) (curNode --> left = newNode) ) (if0 (curDirection == rightward) (block (def newNode 0.0) (temp = (curNode --> right)) (newNode = (new BinTree (temp))) (temp = (newNode --> setValueAt (value nextDirections))) (newNode = (newNode --> root)) (curNode --> right = newNode) ) (temp = (temp / zero)) ) ) (this --> root = curNode) ) ) 0.0 ) (method averageValue () (def root (this --> root)) (def sum (root --> sum ())) (def count (root --> numNodesAndLeaves ())) (sum / count) ) ) ) (import leaf) (timport empty (() ( (addToFront (Number) (() ( (addToFront (Number) Number) (isEmpty () Number) (contains (Number) Number) (length () Number) (get (Number) Number))) ) (isEmpty () Number) (contains (Number) Number) (length () Number) (get (Number) Number))) ) (timport binwrap ( ((root (((value Number)) ()))) ( (setValueAt ( Number (() ( (addToFront (Number) Number) (isEmpty () Number) (contains (Number) Number) (length () Number) (get (Number) Number)) ) ) Number ) (averageValue () Number) ) ) ) (def negOne -1.0) (def zero 0.0) (def one 1.0) (def two 2.0) (def three 3.0) (def four 4.0) (def five 5.0) (def six 6.0) (def leaf (new Leaf (zero))) (def binTree (new BinTree (leaf))) (def list (new Empty ())) (def list (list --> addToFront (negOne))) (def temp (binTree --> setValueAt (one list))) (def list (new Empty ())) (def list (list --> addToFront (negOne))) (def temp (list --> addToFront (one))) (def temp (binTree --> setValueAt (two list))) (def list (new Empty ())) (def list (list --> addToFront (one))) (def temp (list --> addToFront (one))) (def temp (binTree --> setValueAt (three list))) (def list (new Empty ())) (def list (list --> addToFront (one))) (def temp (binTree --> setValueAt (four list))) (def list (new Empty ())) (def list (list --> addToFront (negOne))) (def temp (list --> addToFront (negOne))) (def temp (binTree --> setValueAt (five list))) (def list (new Empty ())) (def list (list --> addToFront (one))) (def temp (list --> addToFront (negOne))) (def temp (binTree --> setValueAt (six list))) (binTree --> averageValue ()) )
